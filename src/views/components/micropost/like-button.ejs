<%# いいねボタンコンポーネント %>
<button 
  class="btn btn-outline-primary btn-sm like-button"
  data-micropost-id="<%= micropost.id %>"
  <%= !user ? 'disabled' : '' %>
>
  <i class="fas <%= isLiked ? 'fa-heart' : 'fa-heart-o' %>"></i>
  <span class="like-count"><%= likeCount %></span>
</button>

<script>
document.querySelectorAll('.like-button').forEach(button => {
  button.addEventListener('click', async function() {
    const micropostId = this.dataset.micropostId;
    const isLiked = this.querySelector('i').classList.contains('fa-heart');
    
    try {
      const response = await fetch(`/microposts/${micropostId}/like`, {
        method: isLiked ? 'DELETE' : 'POST',
        headers: { 'Content-Type': 'application/json' }
      });

      const result = await response.json();
      if (result.success) {
        const icon = this.querySelector('i');
        icon.classList.toggle('fa-heart');
        icon.classList.toggle('fa-heart-o');
        this.querySelector('.like-count').textContent = result.data.likeCount;
      }
    } catch (error) {
      console.error('Error:', error);
    }
  });
});</script> 